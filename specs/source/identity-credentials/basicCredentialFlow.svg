<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/PR-SVG-20010719/DTD/svg10.dtd">
<svg width="30cm" height="20cm" viewBox="39 35 596 386" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="494.682" y1="167.292" x2="325.812" y2="168.237"/>
    <polygon style="fill: #000000" points="318.312,168.279 328.284,163.223 325.812,168.237 328.34,173.223 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="318.312,168.279 328.284,163.223 325.812,168.237 328.34,173.223 "/>
  </g>
  <text font-size="10.16" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="361.686" y="164.865">
    <tspan x="361.686" y="164.865">2. Credentials request</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="104.581" y1="57.983" x2="104.581" y2="58.6901"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="104.581" y1="98.6901" x2="104.581" y2="418.314"/>
    <rect style="fill: #ffffff" x="97.5808" y="58.6901" width="14" height="40"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="97.5808" y="58.6901" width="14" height="40"/>
  </g>
  <g>
    <rect style="fill: #ffffff" x="40.305" y="36.0626" width="143.95" height="52" rx="10" ry="10"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="40.305" y="36.0626" width="143.95" height="52" rx="10" ry="10"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="112.28" y="57.9626">
      <tspan x="112.28" y="57.9626">Identity Provider</tspan>
      <tspan x="112.28" y="73.9626">(credential service)</tspan>
    </text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="312.194" y1="57.82" x2="312.194" y2="58.5271"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="312.194" y1="98.5271" x2="312.194" y2="419.728"/>
    <rect style="fill: #ffffff" x="305.194" y="58.5271" width="14" height="40"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="305.194" y="58.5271" width="14" height="40"/>
  </g>
  <g>
    <rect style="fill: #ffffff" x="269.556" y="36.0626" width="91.1" height="52" rx="10" ry="10"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="269.556" y="36.0626" width="91.1" height="52" rx="10" ry="10"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="315.106" y="57.9626">
      <tspan x="315.106" y="57.9626">User Agent</tspan>
      <tspan x="315.106" y="73.9626">(browser)</tspan>
    </text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="500.854" y1="58.2002" x2="500.854" y2="58.9073"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="500.854" y1="98.9073" x2="500.854" y2="419.728"/>
    <rect style="fill: #ffffff" x="493.854" y="58.9073" width="14" height="40"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="493.854" y="58.9073" width="14" height="40"/>
  </g>
  <g>
    <rect style="fill: #ffffff" x="453.256" y="36.0626" width="104.1" height="52" rx="10" ry="10"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="453.256" y="36.0626" width="104.1" height="52" rx="10" ry="10"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="505.306" y="57.9626">
      <tspan x="505.306" y="57.9626">Relying Party</tspan>
      <tspan x="505.306" y="73.9626">(website)</tspan>
    </text>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="179.312" y="273.358">
    <tspan x="179.312" y="273.358"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="545.594" y="346.896">
    <tspan x="545.594" y="346.896"></tspan>
  </text>
  <g>
    <path style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" d="M 503.874 382.96 C 540.644,375.18 539.936,408.414 512.902,407.895"/>
    <polygon style="fill: #000000" points="505.404,407.751 515.498,402.944 512.902,407.895 515.306,412.942 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="505.404,407.751 515.498,402.944 512.902,407.895 515.306,412.942 "/>
  </g>
  <text font-size="10.16" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="539.584" y="397.21">
    <tspan x="539.584" y="397.21">8. Verify credential</tspan>
    <tspan x="539.584" y="409.91">    digital signature</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="315.784" y1="367.402" x2="489.128" y2="366.756"/>
    <polygon style="fill: #000000" points="496.628,366.728 486.647,371.766 489.128,366.756 486.609,361.766 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="496.628,366.728 486.647,371.766 489.128,366.756 486.609,361.766 "/>
  </g>
  <text font-size="10.16" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="357.856" y="360.44">
    <tspan x="357.856" y="360.44">7. Credentials response</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="111.723" y1="287.794" x2="292.612" y2="288.185"/>
    <polygon style="fill: #000000" points="300.112,288.201 290.101,293.18 292.612,288.185 290.123,283.18 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="300.112,288.201 290.101,293.18 292.612,288.185 290.123,283.18 "/>
  </g>
  <text font-size="10.16" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="144.31" y="282.66">
    <tspan x="144.31" y="282.66">5. Credentials response</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="302.642" y1="248.196" x2="115.802" y2="248.196"/>
    <polygon style="fill: #000000" points="108.302,248.196 118.302,243.196 115.802,248.196 118.302,253.196 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="108.302,248.196 118.302,243.196 115.802,248.196 118.302,253.196 "/>
  </g>
  <text font-size="10.16" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="144.603" y="244.062">
    <tspan x="144.603" y="244.062">4. Credentials request to IdP</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="317.906" y1="126.279" x2="488.066" y2="125.219"/>
    <polygon style="fill: #000000" points="495.566,125.172 485.597,130.234 488.066,125.219 485.535,120.235 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="495.566,125.172 485.597,130.234 488.066,125.219 485.535,120.235 "/>
  </g>
  <text font-size="10.16" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="368.404" y="121.623">
    <tspan x="368.404" y="121.623">1. Access request</tspan>
  </text>
  <g>
    <path style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" d="M 314.494 193.372 C 351.264,185.594 350.556,218.828 323.522,218.307"/>
    <polygon style="fill: #000000" points="316.024,218.163 326.118,213.356 323.522,218.307 325.926,223.355 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="316.024,218.163 326.118,213.356 323.522,218.307 325.926,223.355 "/>
  </g>
  <text font-size="10.16" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="350.204" y="207.624">
    <tspan x="350.204" y="207.624">3. IdP lookup via</tspan>
    <tspan x="350.204" y="220.324">    decentralized query (DHT)</tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="356.088" y="201.94">
    <tspan x="356.088" y="201.94"></tspan>
  </text>
  <g>
    <path style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" d="M 316.616 304.388 C 353.386,296.61 352.678,329.844 325.642,329.323"/>
    <polygon style="fill: #000000" points="318.144,329.179 328.238,324.372 325.642,329.323 328.046,334.371 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="318.144,329.179 328.238,324.372 325.642,329.323 328.046,334.371 "/>
  </g>
  <text font-size="10.16" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="353.032" y="318.638">
    <tspan x="353.032" y="318.638">6. Credentials blinding for Idp</tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="373.766" y="313.662">
    <tspan x="373.766" y="313.662"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="436.7" y="330.634">
    <tspan x="436.7" y="330.634"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="359.624" y="206.89">
    <tspan x="359.624" y="206.89"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="151.028" y="280.428">
    <tspan x="151.028" y="280.428"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="363.868" y="361.746">
    <tspan x="363.868" y="361.746"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="541.35" y="394.98">
    <tspan x="541.35" y="394.98"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="544.18" y="393.566">
    <tspan x="544.18" y="393.566"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="545.594" y="396.394">
    <tspan x="545.594" y="396.394"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="545.594" y="397.102">
    <tspan x="545.594" y="397.102"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="556.908" y="392.152">
    <tspan x="556.908" y="392.152"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="409.948" y="119.915">
    <tspan x="409.948" y="119.915"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="434.696" y="159.513">
    <tspan x="434.696" y="159.513"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="407.826" y="315.076">
    <tspan x="407.826" y="315.076"></tspan>
  </text>
</svg>
